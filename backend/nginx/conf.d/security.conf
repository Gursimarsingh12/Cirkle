# Security configuration for nginx
# Additional security measures and hardening

# Hide nginx version and server information
server_tokens off;
more_clear_headers Server;

# Block common exploit attempts
location ~* \.(php|jsp|cgi|asp|aspx)$ {
    return 444;
}

# Block access to sensitive files
location ~* \.(htaccess|htpasswd|ini|log|sh|sql|conf|bak|backup|swp|tmp)$ {
    deny all;
    return 444;
}

# Block access to hidden files
location ~ /\. {
    deny all;
    return 444;
}

# Prevent access to backup files
location ~* ~$ {
    deny all;
    return 444;
}

# Block user agents
if ($http_user_agent ~* (nmap|nikto|wikto|sf|sqlmap|bsqlbf|w3af|acunetix|havij|appscan)) {
    return 444;
}

# Block suspicious request methods
if ($request_method !~ ^(GET|HEAD|POST|PUT|DELETE|OPTIONS|PATCH)$ ) {
    return 444;
}

# Rate limiting error pages
error_page 429 /429.html;
location = /429.html {
    root /usr/share/nginx/html;
    internal;
} 